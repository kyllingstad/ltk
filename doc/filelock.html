
<html><head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta content="text/javascript" http-equiv="content-script-type">
<title>ltk.filelock</title>
<link rel="stylesheet" type="text/css" href="candydoc/style.css">
<!--[if lt IE 7]><link rel="stylesheet" type="text/css" href="candydoc/ie56hack.css"><![endif]-->
<script language="JavaScript" src="candydoc/util.js" type="text/javascript"></script>
<script language="JavaScript" src="candydoc/tree.js" type="text/javascript"></script>
<script language="JavaScript" src="candydoc/explorer.js" type="text/javascript"></script>
</head><body>
<div id="tabarea"></div><div id="explorerclient"></div>
<div id="content"><script>explorer.initialize("ltk.filelock");</script>
	<table class="content">
		<tr><td id="docbody"><h1>ltk.filelock</h1><!-- Generated by Ddoc from ltk/filelock.d -->
POSIX file locking, the easy way. 
<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">enum 
<span class="currsymbol">LockType</span>
<script>explorer.outline.addDecl('LockType');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Lock types. 
<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">read</span>
<script>explorer.outline.addDecl('read');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>A 
<span class="currsymbol">read</span>
<script>explorer.outline.addDecl('read');</script>

 lock, also known as a "shared lock". There may be multiple
        
<span class="currsymbol">read</span>
<script>explorer.outline.addDecl('read');</script>

 locks on a file, as they do not conflict with each other.
    
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">write</span>
<script>explorer.outline.addDecl('write');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>A 
<span class="currsymbol">write</span>
<script>explorer.outline.addDecl('write');</script>

 lock, also known as an "exclusive lock". When a 
<span class="currsymbol">write</span>
<script>explorer.outline.addDecl('write');</script>

 lock
        has been acquired on a file, no other locks (read or 
<span class="currsymbol">write</span>
<script>explorer.outline.addDecl('write');</script>

) may be
        acquired on the same file until the first one has been released.
<br><br>
A 
<span class="currsymbol">write</span>
<script>explorer.outline.addDecl('write');</script>

 lock cannot be acquired if there is already a lock (read or
        
<span class="currsymbol">write</span>
<script>explorer.outline.addDecl('write');</script>

) on the file.
    
<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">enum 
<span class="currsymbol">OnBlockingLock</span>
<script>explorer.outline.addDecl('OnBlockingLock');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>What to do if a lock cannot be acquired on a file because another
    lock is blocking it.
<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">wait</span>
<script>explorer.outline.addDecl('wait');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Wait for the blocking lock(s) to be released.
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">
<span class="currsymbol">throwException</span>
<script>explorer.outline.addDecl('throwException');</script>

</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Throw an exception.
<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">struct 
<span class="currsymbol">FileLock</span>
<script>explorer.outline.addDecl('FileLock');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>This struct is used to acquire a lock on a file. Note that the
    lock is released automatically as soon as there are no more
    references to it.
<br><br>
<b>Examples:</b><br>
safewriter.d
<pre class="d_code">    <font color=blue>module</font> safewriter;
    <font color=blue>import</font> std.stdio, ltk.filelock;

    <font color=blue>void</font> main(string[] args)
    {
        <font color=blue>assert</font> (args.length &gt; 1);

        <font color=green>// Open file for writing and acquire a write lock.
</font>        <font color=blue>auto</font> file = File(args[1], <font color=red>"w"</font>);
        <font color=blue>auto</font> lock = <u>FileLock</u>(file, LockType.write);

        writeln(<font color=red>"Write contents of file, 'EOF' to end:"</font>);
        <font color=blue>foreach</font> (line; stdin.byLine)
        {
            <font color=blue>if</font> (line == <font color=red>"EOF"</font>) <font color=blue>break</font>;
            file.writeln(line);
        }
    }
</pre>
    safereader.d
<pre class="d_code">    <font color=blue>module</font> safereader;
    <font color=blue>import</font> std.stdio, ltk.filelock;

    <font color=blue>void</font> main(string[] args)
    {
        <font color=blue>assert</font> (args.length &gt; 1);

        <font color=green>// Open file for reading and acquire a read lock.
</font>        <font color=blue>auto</font> file = File(args[1], <font color=red>"r"</font>);
        <font color=blue>auto</font> lock = <u>FileLock</u>(file, LockType.read);

        writeln(<font color=red>"Contents of file:"</font>);
        <font color=blue>foreach</font> (line; file.byLine) writeln(line);
    }
</pre>
<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">this(File <span class="funcparam">file</span>, LockType <span class="funcparam">type</span>, OnBlockingLock <span class="funcparam">action</span> = (OnBlockingLock).wait);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Constructor. 
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">release</span>
<script>explorer.outline.addDecl('release');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Manual 
<span class="currsymbol">release</span>
<script>explorer.outline.addDecl('release');</script>

 of the lock. 
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">bool 
<span class="currsymbol">locked</span>
<script>explorer.outline.addDecl('locked');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Returns <b>true</b> if the lock is set. 
<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</td></tr>
		<tr><td id="docfooter">
			Page was generated with
			<img src="candydoc/img/candydoc.gif" style="vertical-align:middle; position:relative; top:-1px">
			on Wed Mar  3 11:40:10 2010

		</td></tr>
	</table>
</div>
<script>
	explorer.packageExplorer.addModule("ltk.array");
	explorer.packageExplorer.addModule("ltk.filelock");
	explorer.packageExplorer.addModule("ltk.util");</script>
</body></html>


